import functors.functor
import universal_properties_alt.binary_product
import universal_properties_alt.exponent

namespace category_theory

-- This file contains the definition for the exponentiation
-- functor.
-- Check out Pierce, example 71 (2.11, pg. 32).
--
-- For a category C with binary products and exponentiation
-- and a given object c in C, we define the functor (â”€)^c
-- mapping objects b to the exponentiation b^c and morphisms
-- f:bâ†’d to the left component of the unique morphism between
-- b^cÃ—c and d^cÃ—c given by f âˆ˜ ev_b^c : b^cÃ—c â†’ d (defined as
-- exp_hom in exponent.lean).
def exponentiation_functor {ğ’ : category} [has_all_products ğ’] [has_exponentiation ğ’] (c : ğ’) : ğ’ â‡’ ğ’ :=
{
  -- b â†’ b^c
  map_obj := Î» (b : ğ’), (exp b c).ob,
  -- f:bâ†’d â†’ unique morphism as introduced in the description
  map_hom := Î» {b d : ğ’} (f : ğ’.hom b d), exp_hom c f,
  -- id x^c = unique morphism from x^c to x^c given by (id x) âˆ˜ ev_x^c
  -- we prove this by invoking the uniqueness property in this diagram
--                  ev_X^c
--         X^c Ã— c    â†’     X  
--             â†‘         â†—
-- Id_X^cÃ—Id_c |       â†—  ev_X^c
--             |     â†—
--         X^c Ã— c
  id :=
    begin
      intro,
      unfold exp_hom,
      rw ğ’.right_id,
      symmetry,
      apply (exp X c).uu (exp X c).ob (exp X c).ev (ğ’.id (exp X c).ob),
      rw â† identity_morphism_of_product,
      rw ğ’.left_id,
    end,
  -- show the unique arrow generated by exp_hom via gâˆ˜f is equal to the
  -- composition of the arrows generated by exp_hom for g and f, respectively.
  -- exp_hom gâˆ˜f is the unique morphism from X^c to Z^c given by gâˆ˜fâˆ˜ev_X^c
  -- so if we can show gâˆ˜fâˆ˜ev_X^c = (exp_hom g)âˆ˜(exp_hom f) then we're done.
  comp :=
    begin
      intros,
      -- unfold exp_hom's definition to make it clear it's an unique arrow
      rw exp_hom,
      -- move parantheses around, fâˆ˜ev_X^c generates an exp_hom to Y^c
      rw â† ğ’.assoc,
      rw â† simp_exp_hom,
      -- then if we move parantheses again, gâˆ˜ev_Y^c generates another exp_hom to Z^c
      rw ğ’.assoc,
      rw â† simp_exp_hom,
      -- now we can combine the products of morphisms
      -- (change first from product_morphism to pm since that's what we defined
      -- the  omposition lemma with)
      rw refl_product_morphism_pm,
      rw refl_product_morphism_pm,
      rw â† ğ’.assoc,
      rw product_of_composible_morphisms,
      rw â† refl_product_morphism_pm,
      -- simplify the identity composition, now we get a statement that's clearly
      -- true by exponentiation's uniqueness property.
      rw ğ’.left_id,
      symmetry,
      apply (exp Z c).uu (exp X c).ob (ğ’.compose (exp Z c).ev (product_morphism (ğ’.compose (exp_hom c g) (exp_hom c f)) (ğ’.id c))) (ğ’.compose (exp_hom c g) (exp_hom c f)),
      refl,
    end,
}

end category_theory